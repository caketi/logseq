---
title: linux big5
---

## allocating memory 
reading files 
IPC
precise control over memory protection ![image.png](../assets/pages_linux big5_1615951447411_0.png) ![image.png](../assets/pages_linux big5_1615951466279_0.png) ![image.png](../assets/pages_linux big5_1615951565628_0.png) ![image.png](../assets/pages_linux big5_1615951611098_0.png)
## ![image.png](../assets/pages_linux big5_1615905190456_0.png)
##
## 
****
## ![image.png](../assets/pages_linux big5_1615899211729_0.png) ![image.png](../assets/pages_linux big5_1615899255457_0.png)
## At 31:50 you talk about environment variables. However there are some mistakes worth correcting for future viewers. First, although the environment variables are stored in the process' memory, it is stored as zero-terminated strings and not as one big string separated by new-line characters. It is also is not stored on the heap, nor is there a global variable in the data section pointing to it. The environment is actually stored entirely on the stack and is a part of the initial process stack that is set up before the program starts running. The first value on the stack is the argument count followed by an array of the addresses of the different arguments, then address 0 marking the end of the argument array. Right after that there is a second array of addresses which each point to a zero-terminated string which would be the environment variables, this array is also terminated by having address 0 at the end. There is actually a third array of auxiliary vectors but after that there is an unspecified amount of bytes before the information block starts. It's generally inside this block the command line arguments and environment variables are stored, as in the actual string values. You can confirm this by dumping the stack of pretty much any program and you typically find all the environment variables at the very end (highest memory address). If you are on Linux you can do this by first reading the  '/proc/<pid>/maps' file for any process, just replace <pid> with that process' PID. This file contains the ranges of memory mapped to the process and what they are mapped to. Near the bottom you'll see one line with the range mapped to [stack]. Take note of the start address and calculate how big it is in bytes. Then run 'sudo xxd -s <start-address> -l <size-in-bytes> /dev/<pid>/mem', example 'sudo xxd -s 0x7fff182bd000 -l 0x22000 /dev/14950/mem'. And the environment variables should get printed out together with their hex values and address location.

To illustrate this further I've written a small c program that prints all the environment variables using the argv array pointer. As you can see the environment variable pointers are stored pretty much right after argv.

#include <stdio.h>
int main(int argc, char **argv)
{
 for (int i = argc + 2; argv[i] != NULL; i++)
 {
  printf("%s\n", argv[i]);
 }
 return 0;
}


You can of course make it less stupid by using the full version of main which includes a pointer to the first element in the environment pointer array.

#include <stdio.h>
int main(int argc, char **argv, char **envp)
{
 for (int i = 0; envp[i] != NULL; i++)
 {
  printf("%s\n", envp[i]);
 }
 return 0;
}

This is all defined as a part of the ABI (application binary interface) for both the x86 and x86_64 architecture, so 32 and 64 bit desktop computers.

tl;dr: The environment is not a single long string separated by new-line characters. The environment variables and the pointers to them are both stored on the stack or just before it.
## ![image.png](../assets/pages_linux big5_1615898428241_0.png) ![image.png](../assets/pages_linux big5_1615898804364_0.png) ![image.png](../assets/pages_linux big5_1615898936459_0.png) ![image.png](../assets/pages_linux big5_1615893344143_0.png){:height 332, :width 626} ![image.png](../assets/pages_linux big5_1615893405919_0.png) ![image.png](../assets/pages_linux big5_1615893446616_0.png) ![image.png](../assets/pages_linux big5_1615893602340_0.png) ![image.png](../assets/pages_linux big5_1615893773465_0.png) ![image.png](../assets/pages_linux big5_1615893785955_0.png) ![image.png](../assets/pages_linux big5_1615893321634_0.png) ![image.png](../assets/pages_linux big5_1615821636446_0.png) ![image.png](../assets/pages_linux big5_1615875296011_0.png) ![image.png](../assets/pages_linux big5_1615875353532_0.png) ![image.png](../assets/pages_linux big5_1615879249441_0.png) ![image.png](../assets/pages_linux big5_1615879634264_0.png) ![image.png](../assets/pages_linux big5_1615879693716_0.png) ![image.png](../assets/pages_linux big5_1615879829538_0.png) ![image.png](../assets/pages_linux big5_1615879993078_0.png) ![image.png](../assets/pages_linux big5_1615880004354_0.png) ![image.png](../assets/pages_linux big5_1615880337608_0.png) ![image.png](../assets/pages_linux big5_1615880723433_0.png) ![image.png](../assets/pages_linux big5_1615880737396_0.png) ![image.png](../assets/pages_linux big5_1615880787819_0.png) ![image.png](../assets/pages_linux big5_1615880787905_0.png) ![image.png](../assets/pages_linux big5_1615880933506_0.png) ![image.png](../assets/pages_linux big5_1615880960542_0.png) ![image.png](../assets/pages_linux big5_1615881080609_0.png) ![image.png](../assets/pages_linux big5_1615881095118_0.png) ![image.png](../assets/pages_linux big5_1615881139329_0.png) ![image.png](../assets/pages_linux big5_1615881158959_0.png) ![image.png](../assets/pages_linux big5_1615890233476_0.png) ![image.png](../assets/pages_linux big5_1615890307985_0.png) ![image.png](../assets/pages_linux big5_1615890371881_0.png) ![image.png](../assets/pages_linux big5_1615890465755_0.png) ![image.png](../assets/pages_linux big5_1615890927511_0.png) ![image.png](../assets/pages_linux big5_1615890939578_0.png) ![image.png](../assets/pages_linux big5_1615891358938_0.png) ![image.png](../assets/pages_linux big5_1615891566705_0.png) ![image.png](../assets/pages_linux big5_1615891629136_0.png) ![image.png](../assets/pages_linux big5_1615891667471_0.png) ![image.png](../assets/pages_linux big5_1615891857900_0.png) ![image.png](../assets/pages_linux big5_1615891873500_0.png) ****![image.png](../assets/pages_linux big5_1615879177882_0.png) ![image.png](../assets/pages_linux big5_1615875371043_0.png) ![image.png](../assets/pages_linux big5_1615875683255_0.png) ![image.png](../assets/pages_linux big5_1615875799440_0.png) ![image.png](../assets/pages_linux big5_1615877204245_0.png) ![image.png](../assets/pages_linux big5_1615877218188_0.png) ![image.png](../assets/pages_linux big5_1615877251839_0.png) ![image.png](../assets/pages_linux big5_1615877399149_0.png) ![image.png](../assets/pages_linux big5_1615877419200_0.png) ![image.png](../assets/pages_linux big5_1615877558484_0.png) ![image.png](../assets/pages_linux big5_1615877629335_0.png) ![image.png](../assets/pages_linux big5_1615877676884_0.png) ![image.png](../assets/pages_linux big5_1615877697828_0.png) ![image.png](../assets/pages_linux big5_1615877712563_0.png) ![image.png](../assets/pages_linux big5_1615877727474_0.png) ![image.png](../assets/pages_linux big5_1615877779812_0.png) ![image.png](../assets/pages_linux big5_1615877810023_0.png) ![image.png](../assets/pages_linux big5_1615879014952_0.png) ![image.png](../assets/pages_linux big5_1615879137075_0.png) ![image.png](../assets/pages_linux big5_1615877869267_0.png) ![image.png](../assets/pages_linux big5_1615877956900_0.png) ![image.png](../assets/pages_linux big5_1615877968042_0.png) ![image.png](../assets/pages_linux big5_1615878383566_0.png) ![image.png](../assets/pages_linux big5_1615878447637_0.png) ![image.png](../assets/pages_linux big5_1615878516648_0.png) ![image.png](../assets/pages_linux big5_1615878563010_0.png) ![image.png](../assets/pages_linux big5_1615878668010_0.png) ![image.png](../assets/pages_linux big5_1615878893001_0.png) {:height 295, :width 626} ![image.png](../assets/pages_linux big5_1615821763976_0.png){:height 460, :width 626} ![image.png](../assets/pages_linux big5_1615821970779_0.png) ![image.png](../assets/pages_linux big5_1615821990933_0.png) ![image.png](../assets/pages_linux big5_1615822246121_0.png){:height 520, :width 626} ![image.png](../assets/pages_linux big5_1615822518641_0.png) ![image.png](../assets/pages_linux big5_1615822630423_0.png) ![image.png](../assets/pages_linux big5_1615822671795_0.png) ![image.png](../assets/pages_linux big5_1615822798510_0.png) ![image.png](../assets/pages_linux big5_1615822876892_0.png) ![image.png](../assets/pages_linux big5_1615822889534_0.png) ![image.png](../assets/pages_linux big5_1615822942081_0.png) ![image.png](../assets/pages_linux big5_1615822961018_0.png) ![image.png](../assets/pages_linux big5_1615822996080_0.png) ![image.png](../assets/pages_linux big5_1615823317541_0.png) ![image.png](../assets/pages_linux big5_1615823984455_0.png) ![image.png](../assets/pages_linux big5_1615824061451_0.png) ![image.png](../assets/pages_linux big5_1615824110776_0.png) ![image.png](../assets/pages_linux big5_1615824192152_0.png) ![image.png](../assets/pages_linux big5_1615824285241_0.png) ![image.png](../assets/pages_linux big5_1615824370492_0.png) ![image.png](../assets/pages_linux big5_1615824383750_0.png) ![image.png](../assets/pages_linux big5_1615824457636_0.png) ![image.png](../assets/pages_linux big5_1615824525179_0.png) ![image.png](../assets/pages_linux big5_1615824557970_0.png) ![image.png](../assets/pages_linux big5_1615824599998_0.png) ![image.png](../assets/pages_linux big5_1615824725334_0.png) ![image.png](../assets/pages_linux big5_1615824802054_0.png) ![image.png](../assets/pages_linux big5_1615824895309_0.png) ![image.png](../assets/pages_linux big5_1615824915862_0.png) ![image.png](../assets/pages_linux big5_1615824955422_0.png) ![image.png](../assets/pages_linux big5_1615825017444_0.png) ![image.png](../assets/pages_linux big5_1615825089582_0.png) ![image.png](../assets/pages_linux big5_1615825201368_0.png) ![image.png](../assets/pages_linux big5_1615825223105_0.png) ![image.png](../assets/pages_linux big5_1615825260498_0.png) ![image.png](../assets/pages_linux big5_1615825309671_0.png) ![image.png](../assets/pages_linux big5_1615825419618_0.png) ![image.png](../assets/pages_linux big5_1615825432026_0.png) ![image.png](../assets/pages_linux big5_1615825489352_0.png) ![image.png](../assets/pages_linux big5_1615825601791_0.png) ![image.png](../assets/pages_linux big5_1615825639534_0.png) ![image.png](../assets/pages_linux big5_1615825733239_0.png) ![image.png](../assets/pages_linux big5_1615825771517_0.png) ![image.png](../assets/pages_linux big5_1615825806492_0.png) ![image.png](../assets/pages_linux big5_1615862334537_0.png) ![image.png](../assets/pages_linux big5_1615862477556_0.png) ![image.png](../assets/pages_linux big5_1615862491298_0.png) ![image.png](../assets/pages_linux big5_1615862515073_0.png) ![image.png](../assets/pages_linux big5_1615862546585_0.png) ![image.png](../assets/pages_linux big5_1615862557348_0.png) ![image.png](../assets/pages_linux big5_1615862691501_0.png) ![image.png](../assets/pages_linux big5_1615862773332_0.png) ![image.png](../assets/pages_linux big5_1615862853981_0.png) ![image.png](../assets/pages_linux big5_1615862867380_0.png) ![image.png](../assets/pages_linux big5_1615862927926_0.png) ![image.png](../assets/pages_linux big5_1615863321680_0.png) ![image.png](../assets/pages_linux big5_1615864210468_0.png) ![image.png](../assets/pages_linux big5_1615864788469_0.png) ![image.png](../assets/pages_linux big5_1615864835484_0.png) ![image.png](../assets/pages_linux big5_1615864853380_0.png) ![image.png](../assets/pages_linux big5_1615864883621_0.png) ![image.png](../assets/pages_linux big5_1615864934762_0.png) ![image.png](../assets/pages_linux big5_1615864987254_0.png) ![image.png](../assets/pages_linux big5_1615865023822_0.png) ![image.png](../assets/pages_linux big5_1615865123884_0.png) ![image.png](../assets/pages_linux big5_1615865177831_0.png) ![image.png](../assets/pages_linux big5_1615865238342_0.png) ![image.png](../assets/pages_linux big5_1615865285098_0.png) ![image.png](../assets/pages_linux big5_1615865324357_0.png) ![image.png](../assets/pages_linux big5_1615865405740_0.png) ![image.png](../assets/pages_linux big5_1615866026638_0.png) ![image.png](../assets/pages_linux big5_1615866072829_0.png) ![image.png](../assets/pages_linux big5_1615866112794_0.png) ![image.png](../assets/pages_linux big5_1615866262017_0.png) ![image.png](../assets/pages_linux big5_1615866348878_0.png) ![image.png](../assets/pages_linux big5_1615866465487_0.png) ![image.png](../assets/pages_linux big5_1615866655633_0.png) ![image.png](../assets/pages_linux big5_1615866709526_0.png) ![image.png](../assets/pages_linux big5_1615866992619_0.png) ![image.png](../assets/pages_linux big5_1615867291972_0.png) ![image.png](../assets/pages_linux big5_1615867362315_0.png) ![image.png](../assets/pages_linux big5_1615867428406_0.png) ![image.png](../assets/pages_linux big5_1615867557799_0.png) ![image.png](../assets/pages_linux big5_1615867655929_0.png) ![image.png](../assets/pages_linux big5_1615867779641_0.png) ![image.png](../assets/pages_linux big5_1615867812366_0.png) ![image.png](../assets/pages_linux big5_1615868112676_0.png) ![image.png](../assets/pages_linux big5_1615868172405_0.png) ![image.png](../assets/pages_linux big5_1615868185290_0.png) ![image.png](../assets/pages_linux big5_1615868211334_0.png) ![image.png](../assets/pages_linux big5_1615868254906_0.png) ![image.png](../assets/pages_linux big5_1615868296913_0.png) ![image.png](../assets/pages_linux big5_1615868345271_0.png) ![image.png](../assets/pages_linux big5_1615868355928_0.png) ![image.png](../assets/pages_linux big5_1615868404816_0.png) ![image.png](../assets/pages_linux big5_1615868444537_0.png) ![image.png](../assets/pages_linux big5_1615868484403_0.png) ![image.png](../assets/pages_linux big5_1615868504526_0.png) ![image.png](../assets/pages_linux big5_1615868621508_0.png) ![image.png](../assets/pages_linux big5_1615868662054_0.png) ![image.png](../assets/pages_linux big5_1615868948948_0.png) ![image.png](../assets/pages_linux big5_1615869027304_0.png) ![image.png](../assets/pages_linux big5_1615869178710_0.png) ![image.png](../assets/pages_linux big5_1615873574958_0.pn ![image.png](../assets/pages_linux big5_1615891665340_0.png) g)
